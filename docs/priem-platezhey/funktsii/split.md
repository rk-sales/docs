# Сплитование (деление платежей на разные компании)

Сплитование в Robokassa — это механизм, который позволяет **один платёж покупателя автоматически разделить на несколько получателей**: ваши магазины, партнёрские компании, маркетплейс и т.д.
Покупатель платит один раз, а Robokassa распределяет сумму по заданным правилам.

## Когда нужно сплитование

- Маркетплейсы с несколькими продавцами: один заказ — несколько продавцов, каждый получает свою часть.
- Схемы «платформа + партнёр»: часть суммы уходит партнёру, часть — платформе как комиссия.
- Многоюридические структуры: один фронт (сайт/приложение), но несколько компаний, между которыми нужно делить оплату.

Вместо нескольких отдельных платежей для клиента используется один чек и один платёж, а логика распределения реализуется на стороне Robokassa.

## Как работает сплитование

1. Покупатель оформляет заказ и оплачивает его на платёжной странице Robokassa, как обычный платёж.
2. Ваш backend передаёт в Robokassa данные о том, **как делить сумму** между магазинами/компаниями:  
   - список получателей;  
   - доли или фиксированные суммы;  
   - описание позиций (если нужно).  
3. После успешной оплаты Robokassa формирует спецзапрос в формате JSON и распределяет средства по указанным магазинам.
4. В отчётности каждый участник видит «свою» часть платежа, а маркетплейс — суммарную картину.

При этом для покупателя это одна покупка и один платёж, без дополнительных действий.

## Какие схемы разделения поддерживаются

- **По фиксированным долям** — например:  
  - продавец 1 — 70%;  
  - продавец 2 — 20%;  
  - платформа/маркетплейс — 10% комиссия.
- **По фиксированным суммам** — каждая часть задаётся в валюте (например, 1 000 ₽ одному партнёру и 500 ₽ другому).  
- **Комбинированные схемы** — часть в процентах, часть фиксом (комиссия маркетплейса, сервисный сбор и т.п.).

Точные правила вы задаёте в своей системе; Robokassa выполняет распределение по этим правилам.

## Подключение и технические особенности

- Сплитование **не включено по умолчанию** — услуга доступна только по предварительному согласованию с Robokassa.
- Для подключения нужно:
  1. Создать запрос через личный кабинет и согласовать схему работы.
  2. Доработать интеграцию по API:  
     - передавать структуру распределения (JSON) вместе с платёжным запросом;  
     - обрабатывать статусы и уведомления по каждому участнику.
- В процессе работы сохраняется:
  - единая платёжная форма для клиента;  
  - юридическое разделение поступлений по нужным компаниям;  
  - корректная фискализация чеков для каждого участника (по согласованной схеме).

## Преимущества сплитования для бизнеса

- **Один платёж — много получателей.** Упрощает UX для клиента и юридическую схему для маркетплейсов и партнёрок.
- **Автоматическое распределение.** Нет ручных переводов и сверок, всё делится по формуле, заданной в вашей системе. 
- **Прозрачная комиссия платформы.** Маркетплейс может автоматически удерживать свою долю из платежа и видеть её в отчётности.
